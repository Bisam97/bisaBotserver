' Gambas class file

'- - - - - - - - - - - - - - - - Proberty - - - - - - - - - - - - - - - - -
Property CommandName As String
Property Ausgabe As String
Property Read Template As Template
Property Read Authorization As String

'- - - - - - - - - - - Veriabeln - - - - - - - - - - - -
Private $CommandName As String
Private $Ausgabe As String
Private $Template As Template
Private $Authorization As String

Public Sub _new(CommandName As String, Ausgabe As String, Optional Authorization As String, Optional Type As Integer, Optional Syntax As String)

  If InStr(CommandName, "!") = 0 Then CommandName = "!" & CommandName
  If Syntax = Null Then
    Select Case Type
      Case 0
        Syntax &= "Syntax: " & CommandName
      Case 1
        Syntax &= "Syntax: " & CommandName & "$msg"
      Case 2
        Syntax &= "Syntax: " & CommandName

    End Select
  Endif
  ' If Syntax = Null Then
  '
  '   Syntax &= "Syntax: " & CommandName
  '
  ' Endif
  If Authorization = "U" Or Authorization = "M" Or Authorization = "B" Then
  Else
    Authorization = "U"
  Endif

  $Template = New Template(Syntax, Type)
  $CommandName = CommandName
  $Ausgabe = Ausgabe
  $Authorization = Authorization

End

Private Function CommandName_Read() As String

  Return $CommandName

End

Private Sub CommandName_Write(Value As String)

  $CommandName = Value

End

Private Function Ausgabe_Read() As String

  Return $Ausgabe

End

Private Sub Ausgabe_Write(Value As String)

  $Ausgabe = Value

End

Private Function Template_Read() As Template

  Return $Template

End

Private Function Authorization_Read() As String

  Return $Authorization

End

Public Sub ToString() As String[]

  Dim a As New String[]

  a.Add("CommandName")
  a.Add(Me.CommandName)
  a.Add("Ausgabe")
  a.Add(Me.Ausgabe)
  a.Add("Authorization")
  a.Add(Me.Authorization)
  a.Add("Syntax")
  a.Add(Me.Template.Syntax)
  a.Add("Type")
  a.Add(CStr(Me.Template.Type))
  Return a

End
