' Gambas class file

'- - - - - - - - - - - - - - - - Proberty - - - - - - - - - - - - - - - - -
Property logfile As File
Property ID As String
'- - - - - - - - - - - Veriabeln - - - - - - - - - - - -
Private $logfile As File
Private $ID As String
Private $ERROR As String[]

Public Sub _new()

  Me.ID = CString(Day(Now) & Month(Now) & Year(Now) & Hour(Now) & Minute(Now))
  If Not Exist(User.Home & "/logs") Then
    Mkdir User.Home & "/logs"
  Endif
  If Not Exist(User.Home & "/logs/Bisabot") Then
    Mkdir User.Home & "/logs/Bisabot"
  Endif

  Me.logfile = Open User.Home & "/logs/Bisabot/All" & Me.ID & ".log" For Write Create
  Me.logfile.Close()
  $ERROR = New String[]

End

Private Function logfile_Read() As File

  Return $logfile

End

Private Sub logfile_Write(Value As File)

  $logfile = Value

End

Private Function ID_Read() As String

  Return $ID

End

Private Sub ID_Write(Value As String)

  $ID = Value

End

Public Sub Print(msg As String)

  Print msg
  msg &= "\r\n"
  Me.logfile = Open User.Home & "/logs/Bisabot/All" & Me.ID & ".log" For Read Write Append
  Write #Me.logfile, msg, String.Len(msg)
  Me.logfile.Close()
  Me.logfile = Null

End

Public Sub addError(msg As String)

  $ERROR.Add(CStr(Hour(Now) & ":" & Minute(Now) & " ") & msg)
  Me.Print("----------ERROR-------------\n 1 Error was addet to the Error log at the End of this File wen this Programm Close\n This is Error " & CString($ERROR.Length) & " -------------ERROR-END---------------")

End

Public Sub ErrorPrinter()

  Dim s As String

  Me.Print("\n \n \n")
  Me.Print("-----------------------------------Error-Log-------------------------------------------")

  For Each s In $ERROR
    Print("\n" & s & "\n")
  Next

End
